{"ast":null,"code":"var _jsxFileName = \"/Users/hj/develop/myproject/myDiary/client/src/containers/mypage/EditBasicInfo.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport ThemeChange from '../../components/mypage/ThemeChange';\nimport { useSelector } from 'react-redux';\nimport Container from '../../components/common/Container';\nimport ProfileChange from '../../components/common/PhotoUpload';\nimport { theme, BasicTitle, BasicButton } from '../../utils/theme';\nimport { updateInfo, findNickname } from '../../api/user';\nexport default function InfoContainer(props) {\n  const {\n    showEdit,\n    clickEditPw,\n    clickEdit\n  } = props;\n  const userInfo = useSelector(state => state.common.userInfo);\n  const userColor = useSelector(state => state.common.userColor);\n  const {\n    0: changeImgFile,\n    1: setChangeImgFile\n  } = useState([]);\n  const {\n    0: prevImg,\n    1: setPrevImg\n  } = useState('');\n  const {\n    0: checkTimeout,\n    1: setCheckTimeout\n  } = useState(0);\n  const {\n    0: nickname,\n    1: setNickname\n  } = useState('');\n  const {\n    0: mainTitle,\n    1: setMainTitle\n  } = useState('');\n  const {\n    0: nicknameAvailable,\n    1: setNicknameAvailable\n  } = useState('');\n  const {\n    0: res,\n    1: setRes\n  } = useState(false);\n  console.log(userInfo, 'userIn');\n  console.log(props, 'props'); // useEffect(() => {\n  //   setNickname(userInfo && userInfo.nickname);\n  //   setMainTitle(userInfo && userInfo.main_title);\n  // }, []);\n\n  const handlePhotoChange = (file, prevImg) => {\n    setChangeImgFile(file);\n    setPrevImg(prevImg);\n  };\n\n  const handleTitleChange = value => {\n    setMainTitle(value);\n  };\n\n  const handleNicknameChange = value => {\n    // setNicknameAvailable('');\n    const a = insertNickname(value);\n    console.log(a, 'a');\n\n    if (showEdit && value.length > 0) {\n      checkTimeout && clearTimeout(checkTimeout);\n      const timer = setTimeout(() => {\n        const getToken = localStorage.getItem('mydiary_token');\n\n        if (getToken) {\n          const data = {\n            nickname: value\n          };\n          findNickname(data).then(res => {\n            setRes(true);\n            console.log(res, 'res');\n\n            if (res.status === 200) {\n              console.log('ok');\n              setNicknameAvailable(true);\n            } else if (res.status === 400) {\n              console.log('du');\n              setNicknameAvailable(false);\n            }\n          });\n        }\n      }, 3000);\n      setCheckTimeout(timer);\n    }\n  };\n\n  console.log(nickname, 'nick');\n  console.log(mainTitle, 'mainTitles');\n  console.log(nicknameAvailable, 'setNicknameAvailable'); // const checkDuplicateNickname = () => {\n  //   prevPwdTimeout && clearTimeout(prevPwdTimeout);\n  //   const timer = setTimeout(() => {\n  //     console.log('e');\n  //     const getToken = localStorage.getItem('mydiary_token');\n  //     if (getToken) {\n  //       const config = {\n  //         access_token: getToken\n  //       };\n  //       const data = { pwd: nextValue.prevPwd };\n  //       checkPwd(config, data)\n  //         .then(res => {\n  //           console.log(res, 'res');\n  //           if (res.status === 200) {\n  //             console.log('in');\n  //             setPrevPwdTyping(true);\n  //             setPrevPwdState(true);\n  //           }\n  //         })\n  //         .catch(err => {\n  //           if (err.response.status === 401) {\n  //             setPrevPwdTyping(true);\n  //             setPrevPwdState(false);\n  //           }\n  //         });\n  //     }\n  //   }, 2500);\n  //   setPrevPwdTimeout(timer);\n  // };\n\n  const handleSubmit = () => {\n    const formData = new FormData();\n    changeImgFile && changeImgFile.forEach((item, index) => formData.append(`file`, item));\n    console.log(changeImgFile, 'changeImgFile');\n    console.log(formData, 'formData');\n    const data = {\n      nickname: nickname,\n      main_title: mainTitle,\n      user_color: userColor\n    };\n    console.log(data, 'data');\n    formData.append('data', JSON.stringify(data));\n    const token = localStorage.getItem('mydiary_token') && localStorage.getItem('mydiary_token');\n    const config = {\n      access_token: token\n    };\n    updateInfo(config, formData).then(res => {\n      if (res.status === 200) {\n        console.log(res.data, 'res');\n      }\n    });\n  };\n\n  console.log(insertNickname, 'inser');\n  return __jsx(Con, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 5\n    }\n  }, __jsx(Column, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }\n  }, __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 9\n    }\n  }, __jsx(TopCon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 11\n    }\n  }, __jsx(ProfileChange, {\n    clickEdit: clickEdit,\n    imgFormData: handlePhotoChange,\n    prevImg: setPrevImg,\n    showEdit: showEdit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }\n  }), __jsx(MarginRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 13\n    }\n  }, __jsx(Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 15\n    }\n  }, \"\\uB2C9\\uB124\\uC784\"), __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 15\n    }\n  }, showEdit && userInfo ? __jsx(Input, {\n    name: \"nickname\",\n    defaultValue: userInfo.nickname,\n    onChange: e => insertNickname(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 19\n    }\n  }) : userInfo && userInfo.nickname, !!insertNickname && nicknameAvailable && __jsx(Match, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 59\n    }\n  }, \"\\uC0AC\\uC6A9\\uAC00\\uB2A5\"), !insertNickname && !nicknameAvailable && __jsx(Mismatch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 59\n    }\n  }, \"\\uC774\\uBBF8\\uC0AC\\uC6A9\\uC911\\uC785\\uB2C8\\uB2E4.\"))), __jsx(MarginRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 13\n    }\n  }, __jsx(Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 15\n    }\n  }, \"\\uB300\\uD45C\\uBB38\\uAD6C\"), __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 15\n    }\n  }, showEdit && userInfo ? __jsx(Input, {\n    name: \"main_title\",\n    defalutValue: userInfo.main_title,\n    onChange: e => handleTitleChange(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 19\n    }\n  }) : userInfo && userInfo.main_title)), __jsx(MarginRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 13\n    }\n  }, __jsx(ThemeChange, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 15\n    }\n  })), __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 13\n    }\n  }, showEdit && __jsx(SubmitBtn, {\n    onClick: handleSubmit,\n    userColor: userColor,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 17\n    }\n  }, \"\\uBCC0\\uACBD\"))))));\n}\nconst Con = styled(Container).withConfig({\n  displayName: \"EditBasicInfo__Con\",\n  componentId: \"ag8tan-0\"\n})([\"display:flex;justify-content:center;\"]);\nconst Column = styled.div.withConfig({\n  displayName: \"EditBasicInfo__Column\",\n  componentId: \"ag8tan-1\"\n})([\"display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;\"]);\nconst Row = styled.div.withConfig({\n  displayName: \"EditBasicInfo__Row\",\n  componentId: \"ag8tan-2\"\n})([\"display:flex;width:100%;\"]);\nconst MarginRow = styled(Row).withConfig({\n  displayName: \"EditBasicInfo__MarginRow\",\n  componentId: \"ag8tan-3\"\n})([\"margin-bottom:20px;align-items:center;\"]);\nconst Title = styled.div.withConfig({\n  displayName: \"EditBasicInfo__Title\",\n  componentId: \"ag8tan-4\"\n})([\"\", \";width:120px;\"], BasicTitle);\nconst TopCon = styled.div.withConfig({\n  displayName: \"EditBasicInfo__TopCon\",\n  componentId: \"ag8tan-5\"\n})([\"width:100%;background:#fafafa;padding:30px;\"]);\nconst Input = styled.input.withConfig({\n  displayName: \"EditBasicInfo__Input\",\n  componentId: \"ag8tan-6\"\n})([\"width:120px;height:20px;\"]);\nconst SubmitBtn = styled.button.withConfig({\n  displayName: \"EditBasicInfo__SubmitBtn\",\n  componentId: \"ag8tan-7\"\n})([\"\", \";margin:30px auto 0;padding:5px 10px;font-size:\", \";\"], BasicButton, theme.mFont);\nconst Match = styled.div.withConfig({\n  displayName: \"EditBasicInfo__Match\",\n  componentId: \"ag8tan-8\"\n})([\"color:\", \";margin:10px 0 0 0;font-size:\", \";display:flex;align-items:center;\"], theme.greenFont, theme.sFont);\nconst Mismatch = styled.div.withConfig({\n  displayName: \"EditBasicInfo__Mismatch\",\n  componentId: \"ag8tan-9\"\n})([\"color:\", \";margin:10px 0 0 0;font-size:\", \";display:flex;align-items:center;\"], theme.redFont, theme.sFont);\n\nfunction insertNickname(value) {\n  if (value) {\n    return true;\n  } else {\n    return false;\n  }\n}","map":{"version":3,"sources":["/Users/hj/develop/myproject/myDiary/client/src/containers/mypage/EditBasicInfo.js"],"names":["useState","useEffect","styled","ThemeChange","useSelector","Container","ProfileChange","theme","BasicTitle","BasicButton","updateInfo","findNickname","InfoContainer","props","showEdit","clickEditPw","clickEdit","userInfo","state","common","userColor","changeImgFile","setChangeImgFile","prevImg","setPrevImg","checkTimeout","setCheckTimeout","nickname","setNickname","mainTitle","setMainTitle","nicknameAvailable","setNicknameAvailable","res","setRes","console","log","handlePhotoChange","file","handleTitleChange","value","handleNicknameChange","a","insertNickname","length","clearTimeout","timer","setTimeout","getToken","localStorage","getItem","data","then","status","handleSubmit","formData","FormData","forEach","item","index","append","main_title","user_color","JSON","stringify","token","config","access_token","e","target","Con","Column","div","Row","MarginRow","Title","TopCon","Input","input","SubmitBtn","button","mFont","Match","greenFont","sFont","Mismatch","redFont"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport ThemeChange from '../../components/mypage/ThemeChange';\nimport { useSelector } from 'react-redux';\nimport Container from '../../components/common/Container';\nimport ProfileChange from '../../components/common/PhotoUpload';\nimport { theme, BasicTitle, BasicButton } from '../../utils/theme';\nimport { updateInfo, findNickname } from '../../api/user';\n\nexport default function InfoContainer(props) {\n  const { showEdit, clickEditPw, clickEdit } = props;\n  const userInfo = useSelector(state => state.common.userInfo);\n  const userColor = useSelector(state => state.common.userColor);\n  const [changeImgFile, setChangeImgFile] = useState([]);\n  const [prevImg, setPrevImg] = useState('');\n  const [checkTimeout, setCheckTimeout] = useState(0);\n  const [nickname, setNickname] = useState('');\n  const [mainTitle, setMainTitle] = useState('');\n  const [nicknameAvailable, setNicknameAvailable] = useState('');\n  const [res, setRes] = useState(false);\n  console.log(userInfo, 'userIn');\n  console.log(props, 'props');\n  // useEffect(() => {\n  //   setNickname(userInfo && userInfo.nickname);\n  //   setMainTitle(userInfo && userInfo.main_title);\n  // }, []);\n\n  const handlePhotoChange = (file, prevImg) => {\n    setChangeImgFile(file);\n    setPrevImg(prevImg);\n  };\n\n  const handleTitleChange = value => {\n    setMainTitle(value);\n  };\n\n  const handleNicknameChange = value => {\n    // setNicknameAvailable('');\n    const a = insertNickname(value);\n    console.log(a, 'a');\n    if (showEdit && value.length > 0) {\n      checkTimeout && clearTimeout(checkTimeout);\n      const timer = setTimeout(() => {\n        const getToken = localStorage.getItem('mydiary_token');\n        if (getToken) {\n          const data = { nickname: value };\n          findNickname(data).then(res => {\n            setRes(true);\n            console.log(res, 'res');\n            if (res.status === 200) {\n              console.log('ok');\n              setNicknameAvailable(true);\n            } else if (res.status === 400) {\n              console.log('du');\n              setNicknameAvailable(false);\n            }\n          });\n        }\n      }, 3000);\n      setCheckTimeout(timer);\n    }\n  };\n  console.log(nickname, 'nick');\n  console.log(mainTitle, 'mainTitles');\n  console.log(nicknameAvailable, 'setNicknameAvailable');\n  // const checkDuplicateNickname = () => {\n  //   prevPwdTimeout && clearTimeout(prevPwdTimeout);\n  //   const timer = setTimeout(() => {\n  //     console.log('e');\n  //     const getToken = localStorage.getItem('mydiary_token');\n  //     if (getToken) {\n  //       const config = {\n  //         access_token: getToken\n  //       };\n  //       const data = { pwd: nextValue.prevPwd };\n  //       checkPwd(config, data)\n  //         .then(res => {\n  //           console.log(res, 'res');\n  //           if (res.status === 200) {\n  //             console.log('in');\n  //             setPrevPwdTyping(true);\n  //             setPrevPwdState(true);\n  //           }\n  //         })\n  //         .catch(err => {\n  //           if (err.response.status === 401) {\n  //             setPrevPwdTyping(true);\n  //             setPrevPwdState(false);\n  //           }\n  //         });\n  //     }\n  //   }, 2500);\n  //   setPrevPwdTimeout(timer);\n  // };\n  const handleSubmit = () => {\n    const formData = new FormData();\n    changeImgFile && changeImgFile.forEach((item, index) => formData.append(`file`, item));\n    console.log(changeImgFile, 'changeImgFile');\n    console.log(formData, 'formData');\n    const data = {\n      nickname: nickname,\n      main_title: mainTitle,\n      user_color: userColor\n    };\n    console.log(data, 'data');\n    formData.append('data', JSON.stringify(data));\n    const token = localStorage.getItem('mydiary_token') && localStorage.getItem('mydiary_token');\n    const config = {\n      access_token: token\n    };\n    updateInfo(config, formData).then(res => {\n      if (res.status === 200) {\n        console.log(res.data, 'res');\n      }\n    });\n  };\n  console.log(insertNickname, 'inser');\n  return (\n    <Con>\n      <Column>\n        <Row>\n          <TopCon>\n            <ProfileChange\n              clickEdit={clickEdit}\n              imgFormData={handlePhotoChange}\n              prevImg={setPrevImg}\n              showEdit={showEdit}\n            />\n            <MarginRow>\n              <Title>닉네임</Title>\n              <div>\n                {showEdit && userInfo ? (\n                  <Input\n                    name=\"nickname\"\n                    defaultValue={userInfo.nickname}\n                    onChange={e => insertNickname(e.target.value)}\n                  />\n                ) : (\n                  userInfo && userInfo.nickname\n                )}\n                {!!insertNickname && nicknameAvailable && <Match>사용가능</Match>}\n                {!insertNickname && !nicknameAvailable && <Mismatch>이미사용중입니다.</Mismatch>}\n              </div>\n            </MarginRow>\n            <MarginRow>\n              <Title>대표문구</Title>\n              <div>\n                {showEdit && userInfo ? (\n                  <Input\n                    name=\"main_title\"\n                    defalutValue={userInfo.main_title}\n                    onChange={e => handleTitleChange(e.target.value)}\n                  />\n                ) : (\n                  userInfo && userInfo.main_title\n                )}\n              </div>\n            </MarginRow>\n            <MarginRow>\n              <ThemeChange />\n            </MarginRow>\n            <Row>\n              {showEdit && (\n                <SubmitBtn onClick={handleSubmit} userColor={userColor}>\n                  변경\n                </SubmitBtn>\n              )}\n            </Row>\n          </TopCon>\n        </Row>\n      </Column>\n    </Con>\n  );\n}\nconst Con = styled(Container)`\n  display: flex;\n  justify-content: center;\n`;\nconst Column = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  /* margin-top: 30px; */\n  width: 100%;\n`;\nconst Row = styled.div`\n  display: flex;\n  width: 100%;\n`;\nconst MarginRow = styled(Row)`\n  margin-bottom: 20px;\n  align-items: center;\n`;\nconst Title = styled.div`\n  ${BasicTitle};\n  width: 120px;\n`;\nconst TopCon = styled.div`\n  width: 100%;\n  background: #fafafa;\n  padding: 30px;\n`;\nconst Input = styled.input`\n  width: 120px;\n  height: 20px;\n`;\nconst SubmitBtn = styled.button`\n  ${BasicButton};\n  margin: 30px auto 0;\n  padding: 5px 10px;\n  font-size: ${theme.mFont};\n`;\nconst Match = styled.div`\n  color: ${theme.greenFont};\n  margin: 10px 0 0 0;\n  font-size: ${theme.sFont};\n  display: flex;\n  align-items: center;\n`;\nconst Mismatch = styled.div`\n  color: ${theme.redFont};\n  margin: 10px 0 0 0;\n  font-size: ${theme.sFont};\n  display: flex;\n  align-items: center;\n`;\nfunction insertNickname(value) {\n  if (value) {\n    return true;\n  } else {\n    return false;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}