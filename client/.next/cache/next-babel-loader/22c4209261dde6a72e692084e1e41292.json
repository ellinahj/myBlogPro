{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nvar _jsxFileName = \"/Users/hj/develop/myproject/myDiary/client/src/components/blog/ThreePhotoUpload.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport styled, { css } from 'styled-components';\nimport { useState, useRef, useCallback, useEffect } from 'react';\nimport ReactCrop from 'react-image-crop';\nexport default function Upload(props) {\n  var imgFormData = props.imgFormData;\n\n  var _useState = useState([null, null, null]),\n      file = _useState[0],\n      setFile = _useState[1];\n\n  var _useState2 = useState([]),\n      upImg = _useState2[0],\n      setUpImg = _useState2[1];\n\n  var _useState3 = useState({\n    unit: '%',\n    width: 100,\n    aspect: 1\n  }),\n      crop = _useState3[0],\n      setCrop = _useState3[1];\n\n  var _useState4 = useState([null, null, null]),\n      previewUrl = _useState4[0],\n      setPreviewUrl = _useState4[1];\n\n  var _useState5 = useState(null),\n      index = _useState5[0],\n      setIndex = _useState5[1];\n\n  var _useState6 = useState(''),\n      filename = _useState6[0],\n      setFilename = _useState6[1];\n\n  var _useState7 = useState(''),\n      fileInfo = _useState7[0],\n      setFileInfo = _useState7[1];\n\n  var imgRef = useRef(null);\n  var inputRefs = useRef([]);\n\n  var controlFileBtn = function controlFileBtn(e, index) {\n    e.preventDefault();\n    inputRefs.current[index].click();\n  };\n\n  var addImg = function addImg(e, index) {\n    setIndex(index);\n\n    if (e.target.files && e.target.files.length > 0) {\n      var reader = new FileReader();\n      reader.addEventListener('load', function () {\n        return setUpImg(reader.result);\n      });\n      reader.readAsDataURL(e.target.files[0]);\n      setFilename(e.target.files[0].name);\n      setFileInfo(e.target.files[0].type);\n    }\n  };\n\n  var onLoad = useCallback(function (img) {\n    imgRef.current = img;\n  }, []);\n\n  var makeClientCrop = function makeClientCrop(crop) {\n    return _regeneratorRuntime.async(function makeClientCrop$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (imgRef.current && crop.width && crop.height) {\n              createCropPreview(imgRef.current, crop, filename);\n            }\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var createCropPreview = function createCropPreview(image, crop, fileName) {\n    var canvas, scaleX, scaleY, ctx;\n    return _regeneratorRuntime.async(function createCropPreview$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            canvas = document.createElement('canvas');\n            scaleX = image.naturalWidth / image.width;\n            scaleY = image.naturalHeight / image.height;\n            canvas.width = crop.width;\n            canvas.height = crop.height;\n            ctx = canvas.getContext('2d');\n            ctx.drawImage(image, crop.x * scaleX, crop.y * scaleY, crop.width * scaleX, crop.height * scaleY, 0, 0, crop.width, crop.height);\n            return _context2.abrupt(\"return\", new Promise(function (resolve, reject) {\n              canvas.toBlob(function (blob) {\n                if (!blob) {\n                  reject(new Error('Canvas is empty'));\n                  return;\n                }\n\n                blob.name = fileName;\n                window.URL.revokeObjectURL(previewUrl);\n\n                var tempPreviewUrl = _toConsumableArray(previewUrl);\n\n                tempPreviewUrl.splice(index, 1, window.URL.createObjectURL(blob));\n                setPreviewUrl(tempPreviewUrl);\n                var blobToFile = new File([blob], filename);\n\n                var tempFile = _toConsumableArray(file);\n\n                tempFile.splice(index, 1, blobToFile);\n                setFile(tempFile);\n              }, fileInfo);\n            })[\"catch\"](function (err) {\n              console.log('blob promise err', err);\n            }));\n\n          case 8:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    imgFormData(file);\n  }, [file]);\n  return __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 5\n    }\n  }, __jsx(React.Fragment, null, __jsx(ReactCropDiv, {\n    src: upImg,\n    onImageLoaded: onLoad,\n    crop: crop,\n    onChange: function onChange(c) {\n      return setCrop(c);\n    },\n    onComplete: makeClientCrop,\n    uploadImg: upImg,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 9\n    }\n  })), __jsx(ImageRow, {\n    existImg: previewUrl && previewUrl[0],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }\n  }, __jsx(AddBtn, {\n    name: \"button\",\n    onClick: function onClick(e) {\n      return controlFileBtn(e, 0);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 9\n    }\n  }, \"\\uC0AC\\uC9C41\"), __jsx(\"input\", {\n    name: \"file\",\n    type: \"file\",\n    accept: \"image/*\",\n    ref: function ref(_ref) {\n      return inputRefs.current[0] = _ref;\n    },\n    style: {\n      display: 'none'\n    },\n    onChange: function onChange(e) {\n      return addImg(e, 0);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 9\n    }\n  }), previewUrl && previewUrl[0] && __jsx(PreviewImg, {\n    src: previewUrl[0],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 41\n    }\n  }), previewUrl && previewUrl[0] && __jsx(PhotoName, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 41\n    }\n  }, \"\\uC0AC\\uC9C41\")), __jsx(ImageRow, {\n    existImg: previewUrl && previewUrl[1],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }\n  }, __jsx(AddBtn, {\n    name: \"button\",\n    onClick: function onClick(e) {\n      return controlFileBtn(e, 1);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 9\n    }\n  }, \"\\uC0AC\\uC9C42\"), __jsx(\"input\", {\n    name: \"file\",\n    type: \"file\",\n    accept: \"image/*\",\n    ref: function ref(_ref2) {\n      return inputRefs.current[1] = _ref2;\n    },\n    style: {\n      display: 'none'\n    },\n    onChange: function onChange(e) {\n      return addImg(e, 1);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }\n  }), previewUrl && previewUrl[1] && __jsx(PreviewImg, {\n    src: previewUrl[1],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 41\n    }\n  }), previewUrl && previewUrl[1] && __jsx(PhotoName, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 41\n    }\n  }, \"\\uC0AC\\uC9C42\")), __jsx(ImageRow, {\n    existImg: previewUrl && previewUrl[2],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }\n  }, __jsx(AddBtn, {\n    type: \"button\",\n    name: \"file\",\n    onClick: function onClick(e) {\n      return controlFileBtn(e, 2);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 9\n    }\n  }, \"\\uC0AC\\uC9C43\"), __jsx(\"input\", {\n    name: \"file\",\n    type: \"file\",\n    accept: \"image/*\",\n    ref: function ref(_ref3) {\n      return inputRefs.current[2] = _ref3;\n    },\n    style: {\n      display: 'none'\n    },\n    onChange: function onChange(e) {\n      return addImg(e, 2);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 9\n    }\n  }), previewUrl && previewUrl[2] && __jsx(PreviewImg, {\n    src: previewUrl[2],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 41\n    }\n  }), previewUrl && previewUrl[2] && __jsx(PhotoName, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 41\n    }\n  }, \"\\uC0AC\\uC9C43\")));\n}\nvar AddBtn = styled.button.withConfig({\n  displayName: \"ThreePhotoUpload__AddBtn\",\n  componentId: \"k92afb-0\"\n})([\"cursor:pointer;padding:4px 8px;margin-bottom:5px;width:fit-content;\"]);\nvar Row = styled.div.withConfig({\n  displayName: \"ThreePhotoUpload__Row\",\n  componentId: \"k92afb-1\"\n})([\"display:flex;flex-direction:column;align-items:flex-start;\"]);\nvar PreviewImg = styled.img.withConfig({\n  displayName: \"ThreePhotoUpload__PreviewImg\",\n  componentId: \"k92afb-2\"\n})([\"width:100%;\"]);\nvar ImageRow = styled.div.withConfig({\n  displayName: \"ThreePhotoUpload__ImageRow\",\n  componentId: \"k92afb-3\"\n})([\"display:flex;flex-direction:column;margin-bottom:\", \";\"], function (props) {\n  return props.existImg && '30px';\n});\nvar ReactCropDiv = styled(ReactCrop).withConfig({\n  displayName: \"ThreePhotoUpload__ReactCropDiv\",\n  componentId: \"k92afb-4\"\n})([\"border:\", \";margin-bottom:\", \";\"], function (props) {\n  return props.uploadImg.length > 0 ? '2px solid #ff254f' : 'none';\n}, function (props) {\n  return props.uploadImg.length > 0 ? '40px' : '0px';\n});\nvar PhotoName = styled.div.withConfig({\n  displayName: \"ThreePhotoUpload__PhotoName\",\n  componentId: \"k92afb-5\"\n})([\"font-size:15px;margin-top:5px;\"]);","map":{"version":3,"sources":["/Users/hj/develop/myproject/myDiary/client/src/components/blog/ThreePhotoUpload.js"],"names":["styled","css","useState","useRef","useCallback","useEffect","ReactCrop","Upload","props","imgFormData","file","setFile","upImg","setUpImg","unit","width","aspect","crop","setCrop","previewUrl","setPreviewUrl","index","setIndex","filename","setFilename","fileInfo","setFileInfo","imgRef","inputRefs","controlFileBtn","e","preventDefault","current","click","addImg","target","files","length","reader","FileReader","addEventListener","result","readAsDataURL","name","type","onLoad","img","makeClientCrop","height","createCropPreview","image","fileName","canvas","document","createElement","scaleX","naturalWidth","scaleY","naturalHeight","ctx","getContext","drawImage","x","y","Promise","resolve","reject","toBlob","blob","Error","window","URL","revokeObjectURL","tempPreviewUrl","splice","createObjectURL","blobToFile","File","tempFile","err","console","log","c","ref","display","AddBtn","button","Row","div","PreviewImg","ImageRow","existImg","ReactCropDiv","uploadImg","PhotoName"],"mappings":"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","sourcesContent":["import styled, { css } from 'styled-components';\nimport { useState, useRef, useCallback, useEffect } from 'react';\nimport ReactCrop from 'react-image-crop';\n\nexport default function Upload(props) {\n  const { imgFormData } = props;\n  const [file, setFile] = useState([null, null, null]);\n  const [upImg, setUpImg] = useState([]);\n  const [crop, setCrop] = useState({ unit: '%', width: 100, aspect: 1 });\n  const [previewUrl, setPreviewUrl] = useState([null, null, null]);\n  const [index, setIndex] = useState(null);\n  const [filename, setFilename] = useState('');\n  const [fileInfo, setFileInfo] = useState('');\n  const imgRef = useRef(null);\n\n  let inputRefs = useRef([]);\n  const controlFileBtn = (e, index) => {\n    e.preventDefault();\n    inputRefs.current[index].click();\n  };\n\n  const addImg = (e, index) => {\n    setIndex(index);\n    if (e.target.files && e.target.files.length > 0) {\n      const reader = new FileReader();\n      reader.addEventListener('load', () => setUpImg(reader.result));\n      reader.readAsDataURL(e.target.files[0]);\n      setFilename(e.target.files[0].name);\n      setFileInfo(e.target.files[0].type);\n    }\n  };\n\n  const onLoad = useCallback(img => {\n    imgRef.current = img;\n  }, []);\n\n  const makeClientCrop = async crop => {\n    if (imgRef.current && crop.width && crop.height) {\n      createCropPreview(imgRef.current, crop, filename);\n    }\n  };\n\n  const createCropPreview = async (image, crop, fileName) => {\n    const canvas = document.createElement('canvas');\n    const scaleX = image.naturalWidth / image.width;\n    const scaleY = image.naturalHeight / image.height;\n    canvas.width = crop.width;\n    canvas.height = crop.height;\n    const ctx = canvas.getContext('2d');\n\n    ctx.drawImage(\n      image,\n      crop.x * scaleX,\n      crop.y * scaleY,\n      crop.width * scaleX,\n      crop.height * scaleY,\n      0,\n      0,\n      crop.width,\n      crop.height\n    );\n\n    return new Promise((resolve, reject) => {\n      canvas.toBlob(blob => {\n        if (!blob) {\n          reject(new Error('Canvas is empty'));\n          return;\n        }\n        blob.name = fileName;\n        window.URL.revokeObjectURL(previewUrl);\n        const tempPreviewUrl = [...previewUrl];\n        tempPreviewUrl.splice(index, 1, window.URL.createObjectURL(blob));\n        setPreviewUrl(tempPreviewUrl);\n        const blobToFile = new File([blob], filename);\n        const tempFile = [...file];\n        tempFile.splice(index, 1, blobToFile);\n        setFile(tempFile);\n      }, fileInfo);\n    }).catch(err => {\n      console.log('blob promise err', err);\n    });\n  };\n  useEffect(() => {\n    imgFormData(file);\n  }, [file]);\n\n  return (\n    <Row>\n      <>\n        <ReactCropDiv\n          src={upImg}\n          onImageLoaded={onLoad}\n          crop={crop}\n          onChange={c => setCrop(c)}\n          onComplete={makeClientCrop}\n          uploadImg={upImg}\n        />\n      </>\n      <ImageRow existImg={previewUrl && previewUrl[0]}>\n        <AddBtn name=\"button\" onClick={e => controlFileBtn(e, 0)}>\n          사진1\n        </AddBtn>\n        <input\n          name=\"file\"\n          type=\"file\"\n          accept=\"image/*\"\n          ref={ref => (inputRefs.current[0] = ref)}\n          style={{ display: 'none' }}\n          onChange={e => addImg(e, 0)}\n        />\n        {previewUrl && previewUrl[0] && <PreviewImg src={previewUrl[0]} />}\n        {previewUrl && previewUrl[0] && <PhotoName>사진1</PhotoName>}\n      </ImageRow>\n      <ImageRow existImg={previewUrl && previewUrl[1]}>\n        <AddBtn name=\"button\" onClick={e => controlFileBtn(e, 1)}>\n          사진2\n        </AddBtn>\n        <input\n          name=\"file\"\n          type=\"file\"\n          accept=\"image/*\"\n          ref={ref => (inputRefs.current[1] = ref)}\n          style={{ display: 'none' }}\n          onChange={e => addImg(e, 1)}\n        />\n        {previewUrl && previewUrl[1] && <PreviewImg src={previewUrl[1]} />}\n        {previewUrl && previewUrl[1] && <PhotoName>사진2</PhotoName>}\n      </ImageRow>\n      <ImageRow existImg={previewUrl && previewUrl[2]}>\n        <AddBtn type=\"button\" name=\"file\" onClick={e => controlFileBtn(e, 2)}>\n          사진3\n        </AddBtn>\n        <input\n          name=\"file\"\n          type=\"file\"\n          accept=\"image/*\"\n          ref={ref => (inputRefs.current[2] = ref)}\n          style={{ display: 'none' }}\n          onChange={e => addImg(e, 2)}\n        />\n\n        {previewUrl && previewUrl[2] && <PreviewImg src={previewUrl[2]} />}\n        {previewUrl && previewUrl[2] && <PhotoName>사진3</PhotoName>}\n      </ImageRow>\n      {/* <button type=\"button\" onClick={submitImg}>\n        사진전송\n      </button> */}\n    </Row>\n  );\n}\nconst AddBtn = styled.button`\n  cursor: pointer;\n  padding: 4px 8px;\n  margin-bottom: 5px;\n  width: fit-content;\n`;\nconst Row = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n`;\nconst PreviewImg = styled.img`\n  width: 100%;\n`;\nconst ImageRow = styled.div`\n  display: flex;\n  flex-direction: column;\n  margin-bottom: ${props => props.existImg && '30px'};\n`;\nconst ReactCropDiv = styled(ReactCrop)`\n  border: ${props => (props.uploadImg.length > 0 ? '2px solid #ff254f' : 'none')};\n  margin-bottom: ${props => (props.uploadImg.length > 0 ? '40px' : '0px')};\n`;\nconst PhotoName = styled.div`\n  font-size: 15px;\n  margin-top: 5px;\n`;\n"]},"metadata":{},"sourceType":"module"}