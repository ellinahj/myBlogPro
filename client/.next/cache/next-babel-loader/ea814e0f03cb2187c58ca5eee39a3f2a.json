{"ast":null,"code":"var _jsxFileName = \"/Users/hj/develop/myproject/myDiary/client/src/containers/mypage/EditBasicInfo.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport styled from 'styled-components';\nimport ThemeChange from '../../components/mypage/ThemeChange';\nimport { useSelector } from 'react-redux';\nimport Container from '../../components/common/Container';\nimport ProfileChange from '../../components/common/PhotoUpload';\nimport { theme, BasicTitle, BasicButton } from '../../utils/theme';\nimport { updateInfo, findNickname } from '../../api/user';\nimport { setUserInfo } from '../../actions/base';\nimport store from '../../store';\nexport default function InfoContainer(props) {\n  const {\n    setShowEdit,\n    showEdit,\n    clickEditPw,\n    clickEdit\n  } = props;\n  const userInfo = useSelector(state => state.common.userInfo);\n  const userColor = useSelector(state => state.common.userColor);\n  const {\n    0: changeImgFile,\n    1: setChangeImgFile\n  } = useState([]);\n  const {\n    0: prevImg,\n    1: setPrevImg\n  } = useState('');\n  const {\n    0: checkTimeout,\n    1: setCheckTimeout\n  } = useState(0);\n  const {\n    0: nickname,\n    1: setNickname\n  } = useState(undefined);\n  const {\n    0: mainTitle,\n    1: setMainTitle\n  } = useState('');\n  const {\n    0: nicknameAvailable,\n    1: setNicknameAvailable\n  } = useState(null);\n  const dispatch = useDispatch();\n\n  const handlePhotoChange = (file, prevImg) => {\n    setChangeImgFile(file);\n    setPrevImg(prevImg);\n  };\n\n  const handleTitleChange = value => {\n    setMainTitle(value);\n  };\n\n  useEffect(() => {\n    userInfo && setNickname(userInfo.nickname);\n  }, [userInfo]);\n  useEffect(() => {\n    userInfo && setMainTitle(userInfo.main_title);\n  }, [userInfo]);\n\n  const handleNicknameChange = value => {\n    if (value.length > 0) {\n      setNickname(value);\n      setNicknameAvailable(null);\n      checkTimeout && clearTimeout(checkTimeout);\n\n      if (!!value) {\n        const timer = setTimeout(() => {\n          const getToken = localStorage.getItem('mydiary_token');\n\n          if (getToken) {\n            const data = {\n              nickname: value\n            };\n            findNickname(data).then(res => {\n              if (res.status === 200) {\n                setNicknameAvailable(true);\n              } else if (res.status === 422) {\n                setNicknameAvailable(false);\n              }\n            });\n          }\n        }, 2500);\n        setCheckTimeout(timer);\n      }\n    } else {\n      return;\n    }\n  };\n\n  console.log(nickname && nickname.length, 'nickname');\n  console.log(mainTitle, 'mainTitle');\n  console.log(nicknameAvailable, 'setNicknameAvailable');\n\n  const handleSubmit = () => {\n    const formData = new FormData();\n    changeImgFile && changeImgFile.forEach((item, index) => formData.append(`file`, item));\n    console.log(changeImgFile, 'changeImgFile');\n    console.log(formData, 'formData');\n    const data = {\n      nickname: nickname,\n      main_title: mainTitle,\n      user_color: userColor\n    };\n    formData.append('data', JSON.stringify(data));\n    const token = localStorage.getItem('mydiary_token') && localStorage.getItem('mydiary_token');\n    const config = {\n      access_token: token\n    };\n    updateInfo(config, formData).then(res => {\n      if (res.status === 200 && res.data) {\n        dispatch(setUserInfo(res.data));\n        clickEdit('changed');\n        setShowEdit(false);\n      }\n    });\n  };\n\n  return __jsx(Con, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 5\n    }\n  }, __jsx(Column, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }\n  }, __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 9\n    }\n  }, __jsx(TopCon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 11\n    }\n  }, __jsx(ProfileChange, {\n    clickEdit: clickEdit,\n    imgFormData: handlePhotoChange,\n    prevImg: setPrevImg,\n    showEdit: showEdit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }\n  }), __jsx(MarginRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 13\n    }\n  }, __jsx(Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 15\n    }\n  }, \"\\uB2C9\\uB124\\uC784\"), __jsx(InputRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 15\n    }\n  }, showEdit && userInfo ? __jsx(Input, {\n    name: \"nickname\",\n    value: nickname,\n    onChange: e => handleNicknameChange(e.target.value),\n    maxLength: '10',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 19\n    }\n  }) : userInfo && userInfo.nickname, !!nickname && nicknameAvailable === true && __jsx(Match, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 62\n    }\n  }, \"\\uC0AC\\uC6A9\\uAC00\\uB2A5\"), showEdit && __jsx(CountRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 19\n    }\n  }, __jsx(CountNickname, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 21\n    }\n  }, nickname && MAX_NICKNAME - nickname.length), __jsx(Slush, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 21\n    }\n  }, \"/\"), __jsx(Maxcount, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 21\n    }\n  }, MAX_NICKNAME)), !!nickname && nicknameAvailable === false && __jsx(Mismatch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 63\n    }\n  }, \"\\uC774\\uBBF8\\uC0AC\\uC6A9\\uC911\\uC785\\uB2C8\\uB2E4.\"))), __jsx(MarginRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }\n  }, __jsx(Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 15\n    }\n  }, \"\\uB300\\uD45C\\uBB38\\uAD6C\"), __jsx(InputRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 15\n    }\n  }, showEdit && userInfo ? __jsx(Input, {\n    name: \"main_title\",\n    value: mainTitle,\n    onChange: e => handleTitleChange(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 19\n    }\n  }) : userInfo && userInfo.main_title)), __jsx(MarginRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }\n  }, __jsx(ThemeChange, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 15\n    }\n  })), __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 13\n    }\n  }, showEdit && __jsx(SubmitBtn, {\n    disabled: !nicknameAvailable,\n    available: nicknameAvailable === true,\n    onClick: handleSubmit,\n    userColor: userColor,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 17\n    }\n  }, \"\\uBCC0\\uACBD\"))))));\n}\nconst Con = styled(Container).withConfig({\n  displayName: \"EditBasicInfo__Con\",\n  componentId: \"ag8tan-0\"\n})([\"display:flex;justify-content:center;\"]);\nconst Column = styled.div.withConfig({\n  displayName: \"EditBasicInfo__Column\",\n  componentId: \"ag8tan-1\"\n})([\"display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;\"]);\nconst Row = styled.div.withConfig({\n  displayName: \"EditBasicInfo__Row\",\n  componentId: \"ag8tan-2\"\n})([\"display:flex;width:100%;\"]);\nconst MarginRow = styled(Row).withConfig({\n  displayName: \"EditBasicInfo__MarginRow\",\n  componentId: \"ag8tan-3\"\n})([\"margin-bottom:20px;align-items:center;@media screen and (max-width:780px){display:block;}\"]);\nconst Title = styled.div.withConfig({\n  displayName: \"EditBasicInfo__Title\",\n  componentId: \"ag8tan-4\"\n})([\"\", \";width:120px;\"], BasicTitle);\nconst TopCon = styled.div.withConfig({\n  displayName: \"EditBasicInfo__TopCon\",\n  componentId: \"ag8tan-5\"\n})([\"width:100%;background:#fafafa;padding:20px;\"]);\nconst Input = styled.input.withConfig({\n  displayName: \"EditBasicInfo__Input\",\n  componentId: \"ag8tan-6\"\n})([\"width:120px;height:20px;\"]);\nconst SubmitBtn = styled.button.withConfig({\n  displayName: \"EditBasicInfo__SubmitBtn\",\n  componentId: \"ag8tan-7\"\n})([\"\", \";margin:30px auto 0;padding:5px 10px;font-size:\", \";cursor:\", \";\"], BasicButton, theme.mFont, props => props.available === true ? 'pointer' : 'not-allowed');\nconst Match = styled.div.withConfig({\n  displayName: \"EditBasicInfo__Match\",\n  componentId: \"ag8tan-8\"\n})([\"color:\", \";margin:10px 0 0 0;font-size:\", \";display:flex;align-items:center;\"], theme.greenFont, theme.sFont);\nconst Mismatch = styled.div.withConfig({\n  displayName: \"EditBasicInfo__Mismatch\",\n  componentId: \"ag8tan-9\"\n})([\"color:\", \";margin:10px 0 0 0;font-size:\", \";display:flex;align-items:center;\"], theme.redFont, theme.sFont);\nconst InputRow = styled.div.withConfig({\n  displayName: \"EditBasicInfo__InputRow\",\n  componentId: \"ag8tan-10\"\n})([\"display:flex;align-items:center;@media screen and (max-width:780px){margin-top:10px;}\"]);\nconst CountRow = styled.div.withConfig({\n  displayName: \"EditBasicInfo__CountRow\",\n  componentId: \"ag8tan-11\"\n})([\"display:flex;\"]);\nconst CountNickname = styled.div.withConfig({\n  displayName: \"EditBasicInfo__CountNickname\",\n  componentId: \"ag8tan-12\"\n})([\"color:#aaa;margin-left:10px;font-size:\", \";\"], theme.mFont);\nconst Slush = styled.div.withConfig({\n  displayName: \"EditBasicInfo__Slush\",\n  componentId: \"ag8tan-13\"\n})([\"color:#aaa;margin:0 2px 0;font-size:\", \";\"], theme.mFont);\nconst Maxcount = styled.span.withConfig({\n  displayName: \"EditBasicInfo__Maxcount\",\n  componentId: \"ag8tan-14\"\n})([\"color:#444;font-size:\", \";\"], theme.mFont);\nconst MAX_NICKNAME = 10;","map":{"version":3,"sources":["/Users/hj/develop/myproject/myDiary/client/src/containers/mypage/EditBasicInfo.js"],"names":["useState","useEffect","useDispatch","styled","ThemeChange","useSelector","Container","ProfileChange","theme","BasicTitle","BasicButton","updateInfo","findNickname","setUserInfo","store","InfoContainer","props","setShowEdit","showEdit","clickEditPw","clickEdit","userInfo","state","common","userColor","changeImgFile","setChangeImgFile","prevImg","setPrevImg","checkTimeout","setCheckTimeout","nickname","setNickname","undefined","mainTitle","setMainTitle","nicknameAvailable","setNicknameAvailable","dispatch","handlePhotoChange","file","handleTitleChange","value","main_title","handleNicknameChange","length","clearTimeout","timer","setTimeout","getToken","localStorage","getItem","data","then","res","status","console","log","handleSubmit","formData","FormData","forEach","item","index","append","user_color","JSON","stringify","token","config","access_token","e","target","MAX_NICKNAME","Con","Column","div","Row","MarginRow","Title","TopCon","Input","input","SubmitBtn","button","mFont","available","Match","greenFont","sFont","Mismatch","redFont","InputRow","CountRow","CountNickname","Slush","Maxcount","span"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport styled from 'styled-components';\nimport ThemeChange from '../../components/mypage/ThemeChange';\nimport { useSelector } from 'react-redux';\nimport Container from '../../components/common/Container';\nimport ProfileChange from '../../components/common/PhotoUpload';\nimport { theme, BasicTitle, BasicButton } from '../../utils/theme';\nimport { updateInfo, findNickname } from '../../api/user';\nimport { setUserInfo } from '../../actions/base';\nimport store from '../../store';\n\nexport default function InfoContainer(props) {\n  const { setShowEdit, showEdit, clickEditPw, clickEdit } = props;\n  const userInfo = useSelector(state => state.common.userInfo);\n  const userColor = useSelector(state => state.common.userColor);\n  const [changeImgFile, setChangeImgFile] = useState([]);\n  const [prevImg, setPrevImg] = useState('');\n  const [checkTimeout, setCheckTimeout] = useState(0);\n  const [nickname, setNickname] = useState(undefined);\n  const [mainTitle, setMainTitle] = useState('');\n  const [nicknameAvailable, setNicknameAvailable] = useState(null);\n  const dispatch = useDispatch();\n\n  const handlePhotoChange = (file, prevImg) => {\n    setChangeImgFile(file);\n    setPrevImg(prevImg);\n  };\n\n  const handleTitleChange = value => {\n    setMainTitle(value);\n  };\n  useEffect(() => {\n    userInfo && setNickname(userInfo.nickname);\n  }, [userInfo]);\n\n  useEffect(() => {\n    userInfo && setMainTitle(userInfo.main_title);\n  }, [userInfo]);\n\n  const handleNicknameChange = value => {\n    if (value.length > 0) {\n      setNickname(value);\n      setNicknameAvailable(null);\n      checkTimeout && clearTimeout(checkTimeout);\n\n      if (!!value) {\n        const timer = setTimeout(() => {\n          const getToken = localStorage.getItem('mydiary_token');\n          if (getToken) {\n            const data = { nickname: value };\n            findNickname(data).then(res => {\n              if (res.status === 200) {\n                setNicknameAvailable(true);\n              } else if (res.status === 422) {\n                setNicknameAvailable(false);\n              }\n            });\n          }\n        }, 2500);\n        setCheckTimeout(timer);\n      }\n    } else {\n      return;\n    }\n  };\n  console.log(nickname && nickname.length, 'nickname');\n  console.log(mainTitle, 'mainTitle');\n  console.log(nicknameAvailable, 'setNicknameAvailable');\n\n  const handleSubmit = () => {\n    const formData = new FormData();\n    changeImgFile && changeImgFile.forEach((item, index) => formData.append(`file`, item));\n    console.log(changeImgFile, 'changeImgFile');\n    console.log(formData, 'formData');\n    const data = {\n      nickname: nickname,\n      main_title: mainTitle,\n      user_color: userColor\n    };\n    formData.append('data', JSON.stringify(data));\n    const token = localStorage.getItem('mydiary_token') && localStorage.getItem('mydiary_token');\n    const config = {\n      access_token: token\n    };\n    updateInfo(config, formData).then(res => {\n      if (res.status === 200 && res.data) {\n        dispatch(setUserInfo(res.data));\n        clickEdit('changed');\n        setShowEdit(false);\n      }\n    });\n  };\n  return (\n    <Con>\n      <Column>\n        <Row>\n          <TopCon>\n            <ProfileChange\n              clickEdit={clickEdit}\n              imgFormData={handlePhotoChange}\n              prevImg={setPrevImg}\n              showEdit={showEdit}\n            />\n            <MarginRow>\n              <Title>닉네임</Title>\n              <InputRow>\n                {showEdit && userInfo ? (\n                  <Input\n                    name=\"nickname\"\n                    value={nickname}\n                    onChange={e => handleNicknameChange(e.target.value)}\n                    maxLength={'10'}\n                  />\n                ) : (\n                  userInfo && userInfo.nickname\n                )}\n                {!!nickname && nicknameAvailable === true && <Match>사용가능</Match>}\n\n                {showEdit && (\n                  <CountRow>\n                    <CountNickname>{nickname && MAX_NICKNAME - nickname.length}</CountNickname>\n                    <Slush>/</Slush>\n                    <Maxcount>{MAX_NICKNAME}</Maxcount>\n                  </CountRow>\n                )}\n                {!!nickname && nicknameAvailable === false && <Mismatch>이미사용중입니다.</Mismatch>}\n              </InputRow>\n            </MarginRow>\n            <MarginRow>\n              <Title>대표문구</Title>\n              <InputRow>\n                {showEdit && userInfo ? (\n                  <Input name=\"main_title\" value={mainTitle} onChange={e => handleTitleChange(e.target.value)} />\n                ) : (\n                  userInfo && userInfo.main_title\n                )}\n              </InputRow>\n            </MarginRow>\n            <MarginRow>\n              <ThemeChange />\n            </MarginRow>\n            <Row>\n              {showEdit && (\n                <SubmitBtn\n                  disabled={!nicknameAvailable}\n                  available={nicknameAvailable === true}\n                  onClick={handleSubmit}\n                  userColor={userColor}\n                >\n                  변경\n                </SubmitBtn>\n              )}\n            </Row>\n          </TopCon>\n        </Row>\n      </Column>\n    </Con>\n  );\n}\nconst Con = styled(Container)`\n  display: flex;\n  justify-content: center;\n`;\nconst Column = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  /* margin-top: 30px; */\n  width: 100%;\n`;\nconst Row = styled.div`\n  display: flex;\n  width: 100%;\n`;\nconst MarginRow = styled(Row)`\n  margin-bottom: 20px;\n  align-items: center;\n  @media screen and (max-width: 780px) {\n    display: block;\n  }\n`;\nconst Title = styled.div`\n  ${BasicTitle};\n  width: 120px;\n`;\nconst TopCon = styled.div`\n  width: 100%;\n  background: #fafafa;\n  padding: 20px;\n`;\nconst Input = styled.input`\n  width: 120px;\n  height: 20px;\n`;\nconst SubmitBtn = styled.button`\n  ${BasicButton};\n  margin: 30px auto 0;\n  padding: 5px 10px;\n  font-size: ${theme.mFont};\n  cursor: ${props => (props.available === true ? 'pointer' : 'not-allowed')};\n`;\nconst Match = styled.div`\n  color: ${theme.greenFont};\n  margin: 10px 0 0 0;\n  font-size: ${theme.sFont};\n  display: flex;\n  align-items: center;\n`;\nconst Mismatch = styled.div`\n  color: ${theme.redFont};\n  margin: 10px 0 0 0;\n  font-size: ${theme.sFont};\n  display: flex;\n  align-items: center;\n`;\nconst InputRow = styled.div`\n  display: flex;\n  align-items: center;\n  @media screen and (max-width: 780px) {\n    margin-top: 10px;\n  }\n`;\nconst CountRow = styled.div`\n  display: flex;\n`;\nconst CountNickname = styled.div`\n  color: #aaa;\n  margin-left: 10px;\n  font-size: ${theme.mFont};\n`;\nconst Slush = styled.div`\n  color: #aaa;\n  margin: 0 2px 0;\n  font-size: ${theme.mFont};\n`;\nconst Maxcount = styled.span`\n  color: #444;\n  font-size: ${theme.mFont};\n`;\n\nconst MAX_NICKNAME = 10;\n"]},"metadata":{},"sourceType":"module"}